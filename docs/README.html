<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.7: http://docutils.sourceforge.net/" />
<title></title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 6253 2010-03-02 00:24:53Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: left }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document">


<div class="section" id="instalation">
<h1>Instalation</h1>
<div class="section" id="source">
<h2>Source</h2>
<p>Install from source by running <cite>python setup.py install</cite>
in main directory.</p>
</div>
<div class="section" id="pypi">
<h2>Pypi</h2>
<p>To install from Python Package Index use
<cite>pip install dfuzz</cite> or <cite>easy_install dfuzz</cite>.</p>
</div>
<div class="section" id="requirements">
<h2>Requirements</h2>
<dl class="docutils">
<dt>One of:</dt>
<dd><ul class="first last simple">
<li>zzuf - <a class="reference external" href="http://caca.zoy.org/wiki/zzuf">http://caca.zoy.org/wiki/zzuf</a></li>
<li>autodafe - <a class="reference external" href="http://autodafe.sourceforge.net/">http://autodafe.sourceforge.net/</a></li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="optional-tools">
<h2>Optional tools</h2>
<blockquote>
<ul class="simple">
<li>GDB - GNU Debugger - probably present in your distribution</li>
<li>Valgrind - memory analyzer - <a class="reference external" href="http://valgrind.org/">http://valgrind.org/</a></li>
<li>no_commets - comment stripping utility - <a class="reference external" href="https://github.com/sorki/no_comments">https://github.com/sorki/no_comments</a></li>
</ul>
</blockquote>
</div>
</div>
<div class="section" id="usage">
<h1>Usage</h1>
<div class="section" id="basic-usage">
<h2>Basic usage</h2>
<blockquote>
<ul>
<li><p class="first">Create work directory (referenced as <cite>work_dir</cite>)</p>
</li>
<li><p class="first">In the directory, create <cite>fuzz.conf</cite> file</p>
</li>
<li><dl class="first docutils">
<dt>Set two values in the section named <cite>[global]</cite></dt>
<dd><ul class="first last simple">
<li><cite>binary = binary_to_test</cite> where <cite>binary_to_test</cite> is in located in your work directory or in your <cite>$PATH</cite></li>
<li><cite>args = -f FUZZED_FILE</cite> - arguments passed to the specified binary. <cite>FUZZED_FILE</cite> is replaced with proper path to file which is currently being fuzzed</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">Create <cite>work_dir/mut</cite> subdirectory</p>
</li>
<li><p class="first">Put configuration file which should be mutated to the <cite>work_dir/mut</cite> subdirectory</p>
</li>
<li><p class="first">Run <cite>dfuzz</cite> with <cite>--debug</cite> and <cite>--debug_output</cite> parameters:</p>
<pre class="literal-block">
dfuzz --debug --debug_output &lt;path_to_work_dir&gt;
</pre>
</li>
<li><p class="first">Check output for errors</p>
</li>
<li><p class="first">Check <cite>work_dir/samples</cite> directory
- open one of the samples and check whether the output is correct
- try to run one of the samples with <cite>run_XY</cite> script</p>
</li>
</ul>
</blockquote>
<p>This procedure will test specified binary with 10 mutated files.
The files are mutated with zzuf. If everything is fine, we
can start real testing.</p>
<blockquote>
<ul>
<li><p class="first">Open the <cite>fuzz.conf</cite> file and add the following section:</p>
<pre class="literal-block">
[mutation]
modules = dfuzz.mut.zzuf
priority = high
</pre>
</li>
<li><p class="first">This will cause the removal of 10 mutations limit</p>
</li>
<li><p class="first">Run <cite>dfuzz</cite> again, now without debugging options:</p>
<pre class="literal-block">
dfuzz &lt;path_to_work_dir&gt;
</pre>
</li>
</ul>
</blockquote>
<p>Now <cite>dfuzz</cite> will test specified binary 10k times with
10k different mutations. If it finds any incidents
it will report the fact at the end of the test run.
If there are any incidents, run <cite>incident_viewer</cite> tool:</p>
<pre class="literal-block">
incident_viewer &lt;path_to_incidents_subdir&gt;
</pre>
<p>This completes basic usage tutorial.</p>
</div>
<div class="section" id="using-autodafe">
<h2>Using Autodafe</h2>
<p>To take advantage of this tool you have to create
<cite>gen</cite> subdirectory the same way as <cite>mut</cite> subdirectory.
Then you have to create an Autodafe template and put it into
the <cite>gen</cite> subdirectory. You can now rerun the testing - <cite>dfuzz</cite>
will detect the existence of the template and will run Autodafe
generation routines (along with zzuf testing).</p>
</div>
<div class="section" id="disabling-fuzzing-methods">
<h2>Disabling fuzzing methods</h2>
<p>The following part of the configuration file illustrates the way
how to enable or disable one of the fuzzing methods:</p>
<pre class="literal-block">
[global]
generation  = 1
mutation    = 1
combination = 0
</pre>
<p>By default, combination will combine Autodafe and Zzuf modules provided
that there is <cite>comb</cite> subdirectory present in your work dir and there
is an Autodafe template to work with.</p>
</div>
<div class="section" id="method-customization">
<h2>Method customization</h2>
<p>Each of the fuzzing methods is highly configurable. It is
possible to set which classes to use, set their parameters and
priority of the method. Default configuration follows</p>
<pre class="literal-block">
[generation]
modules  = dfuzz.gen.autodafe
priority = low

[mutation]
modules = dfuzz.mut.zzuf_10
priority = high

[combination]
modules = dfuzz.comb.simple
priority = low
</pre>
<p>Class <cite>dfuzz.mut.zzuf_10</cite> will create 10 mutations of the input.
It's a subclass of <cite>dfuzz.mut.zzuf</cite> which is used as a main class
for fuzz testing. Class <cite>dfuzz.mut.zzuf</cite> accepts three parameters:</p>
<blockquote>
<ul class="simple">
<li>minimal percentage of bytes to fuzz</li>
<li>maximal percentage of bytes to fuzz</li>
<li>number of mutations to create (with different seeds)</li>
</ul>
</blockquote>
<p>Best illustrated by an example::</p>
<pre class="literal-block">
[mutation]
modules = dfuzz.mut.zzuf(0.01, 0.2, 500)
priority = high
</pre>
<p>This will set the range of the bytes to fuzz to 0.1% to 0.2%
and will produce 500 different mutations of the input.</p>
<p>Combination class <cite>dfuzz.comb.simple</cite> accepts
two parameters - classes to combine. Its default behaviour
is illustrated by following example:</p>
<pre class="literal-block">
[combination]
modules = dfuzz.comb.simple(dfuzz.gen.autodafe, dfuzz.mut.zzuf_10)
priority = low
</pre>
<p>So by default class combines generation of files by Autodafe with their
mutation by Zzuf. To save time, only 10 mutation of each file are done.</p>
<div class="section" id="priorities-threading">
<h3>Priorities &amp; threading</h3>
<p>Priority of each method can be set to <cite>low</cite> or <cite>high</cite>. High priority methods
will precede low priority ones.</p>
<p>It's also possible to run multiple fuzzers simultaneously in threads.
Number of threads is specified by <cite>threads = X</cite> option. Default
setting is <cite>threads = 1</cite> as most of the Linux daemons require
open ports or exclusive access to files.</p>
</div>
<div class="section" id="supplying-plain-files">
<h3>Supplying plain files</h3>
<p>If you posses test files which are/were problematic
you can supply them during the testing directly without
prior fuzzing. Class for the job is <cite>dfuzz.mut.plain</cite>
which only copies its input to the output directory.</p>
</div>
<div class="section" id="creating-new-wrapper-fuzzer-class">
<h3>Creating new wrapper/fuzzer class</h3>
<p>Modularity and dynamic module loading allows
simple creation of fuzzers or wrappers for
existing fuzzers.</p>
<p>This is done by subclassing <cite>dfuzz.core.wrapper.DfuzzWrapper</cite>.
New class has to implement following methods:</p>
<blockquote>
<ul class="simple">
<li><cite>__str__</cite> - which should return short name of the class</li>
<li><cite>method</cite> - which returns one of <cite>mut/gen/comb</cite> method identifiers</li>
<li><cite>set_up</cite> - accepts input file path and parameters supplied via config</li>
<li><cite>run</cite> - returns generator which yields full paths to output file</li>
</ul>
</blockquote>
<p>When creating new fuzzer or wrapper it's best to look at one
of the existing classes.</p>
</div>
</div>
<div class="section" id="using-external-tools">
<h2>Using external tools</h2>
<p><cite>Dfuzz</cite> can take an advantage of two external tools:</p>
<blockquote>
<ul class="simple">
<li>GDB - GNU Debugger</li>
<li>Valgrind - runtime memory analyzer</li>
</ul>
</blockquote>
<p>To enable these tools put following snippet into your <cite>fuzz.conf</cite> file:</p>
<pre class="literal-block">
[core]
target=dfuzz.core.target.TimedValgrindTarget
incident=dfuzz.core.incident.TimeValgrindIncident
incident_handler=dfuzz.core.handler.GDBFileIncidentHandler
</pre>
<p>Again, modularity allows you to use your own classes.
Implementation of target runners or handlers is not covered in this guide.</p>
<div class="section" id="handling-timeouts">
<h3>Handling timeouts</h3>
<p>Default timeout for single test is set to 3 seconds. If it is exceeded
tested application is killed.</p>
<p>It is possible to record timeouts as incident with <cite>timeout_as_incident = 1</cite> option.</p>
</div>
</div>
<div class="section" id="other-configuration-options">
<h2>Other configuration options</h2>
<p>Documented with comments next to their default value:</p>
<pre class="literal-block">
[global]
num_samples = 2 ; number of output samples to store

[file]
use_no_fuzz = 0 ; append/prepend/0 ; turns on the inclusion of no_fuzz_file
; specified in input section. Values are self explanatory.
; This file is inserted to the output _after_ fuzzing process.

[input]
no_fuzz_file = no_fuzz ; name of no_fuzz file

gen_dir  = gen ; generation templates directory
mut_dir  = mut ; mutation inputs directory
comb_dir = comb ; combination inputs directory

gen_dir_mask  = * ; masks for respective directory, used to filter files
mut_dir_mask  = * ; same way the shell works
comb_dir_mask = *

[output]
tmp_dir = tmp ; temporary directory, used to store outputs
samples_dir = samples ; samples directory

incidents_dir    = incidents ; directory where the incidents are stored
incident_format  = U ; `U` - uuid `I` - #nth incident

; filenames of the files which are generated
; by default incident handler
incident_info    = info
incident_input   = input
incident_stdout  = stdout
incident_stderr  = stderr
incident_minimal = input_minimal
incident_valgrind = valgrind
incident_reproduce  = reproduce.sh
</pre>
</div>
</div>
</div>
</body>
</html>
